webpackJsonp([6],{"4hqv":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("IHPB"),r=i.n(o),n=i("OVQD"),a={name:"uploadPicture",data:function(){return{visible:!0,preViewVisible:!1,preViewURL:"",activeTab:"upload",freePictureList:[],uploadFileList:[],selectFileList:[],keyWord:"",page:1,loading:!1,more_loading:!1,lock:!1}},watch:{visible:function(e){e||this.$emit("close",!1)}},methods:{handleClick:function(e){var t=this;"select"===this.activeTab?this.$nextTick(function(){t.$el.querySelector(".imgWrapper").addEventListener("scroll",t.onScroll)}):this.$el.querySelector(".imgWrapper").removeEventListener("scroll",this.onScroll)},uploadBefore:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type,i=e.size/1024/1024<5;return t?i||this.$message.error("上传图片大小不能超过 5MB"):this.$message.error("目前只支持 jpg / png / gif 的图片格式"),t&&i},onSuccess:function(e,t,i){this.uploadFileList=i},onError:function(e,t,i){console.log("上传图片失败",e),this.$message.error("上传失败，请重新尝试!")},onRemove:function(e,t){this.uploadFileList=t},onPreview:function(e){this.preViewURL=e.url,this.preViewVisible=!0},complete:function(){var e=[],t=!0;"upload"===this.activeTab?this.uploadFileList.forEach(function(i,o){i.response?e.push(i.response.data):t=!1}):"select"===this.activeTab&&(e=this.selectFileList),t||this.$message.warning("部分图片没有上传成功，请重新尝试"),this.$emit("complete",e),this.visible=!1},cancle:function(){this.visible=!1},get_picture:function(){var e=this;this.freePictureList=[],this.selectFileList=[],this.more_loading=!1,this.loading=!0;var t={key:this.keyWord,page:1};Object(n.d)(t).then(function(t){t.data?(e.freePictureList=t.data,e.page=2):(e.freePictureList=[],e.loading="nothing"),e.loading=!1}).catch(function(t){console.log(t),e.itemJson=[],e.loading="error"})},get_picture_more:function(){var e=this;this.more_loading=!0;var t={key:this.keyWord,page:this.page};Object(n.d)(t).then(function(t){var i;t.data?((i=e.freePictureList).push.apply(i,r()(t.data)),e.page++):e.more_loading="nothing";e.more_loading=!1,e.lock=!1}).catch(function(t){console.log(t),e.more_loading="error",e.lock=!1})},onScroll:function(){var e=this,t=this.$el.querySelector(".imgWrapper"),i=this.$el.querySelector(".img-list"),o=void 0;o&&clearTimeout(o),o=setTimeout(function(){var o=t.scrollTop+t.offsetHeight>=i.offsetHeight,r=e.freePictureList.length>0&&!e.more_loading&&e.page>=2;o&&r&&!e.lock&&(e.get_picture_more(),e.lock=!0)},150)}}},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"uploadPicture",attrs:{visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[i("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{staticClass:"upload",attrs:{label:"上传图片",name:"upload"}},[i("el-upload",{ref:"upload",attrs:{action:"http://api.toutiaojk.com/e/extend/jkh/upload_file.php","list-type":"picture-card",multiple:!0,"before-upload":e.uploadBefore,"on-success":e.onSuccess,"on-error":e.onError,"on-remove":e.onRemove,"on-preview":e.onPreview}},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("el-dialog",{staticClass:"picture_preview",attrs:{visible:e.preViewVisible,modal:!1,"append-to-body":"",width:"30%"},on:{"update:visible":function(t){e.preViewVisible=t}}},[i("img",{attrs:{width:"100%",src:e.preViewURL}})])],1)],1),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"cancle_btn",on:{click:function(t){return t.stopPropagation(),e.cancle(t)}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.complete}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var l=i("vSla")(a,s,!1,function(e){i("gu+v")},null,null);t.default=l.exports},IHPB:function(e,t,i){"use strict";t.__esModule=!0;var o,r=i("kfHR"),n=(o=r)&&o.__esModule?o:{default:o};t.default=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return(0,n.default)(e)}},"gu+v":function(e,t){},kfHR:function(e,t,i){e.exports={default:i("qQfv"),__esModule:!0}},kksE:function(e,t,i){"use strict";var o=i("lIiZ"),r=i("go9Q");e.exports=function(e,t,i){t in e?o.f(e,t,r(0,i)):e[t]=i}},qQfv:function(e,t,i){i("IsPG"),i("yrDz"),e.exports=i("AKd3").Array.from},yrDz:function(e,t,i){"use strict";var o=i("WwGG"),r=i("FITv"),n=i("OXaN"),a=i("kDTw"),s=i("V2W7"),l=i("CFGK"),c=i("kksE"),u=i("YW8S");r(r.S+r.F*!i("75+0")(function(e){Array.from(e)}),"Array",{from:function(e){var t,i,r,p,f=n(e),d="function"==typeof this?this:Array,v=arguments.length,h=v>1?arguments[1]:void 0,g=void 0!==h,m=0,b=u(f);if(g&&(h=o(h,v>2?arguments[2]:void 0,2)),void 0==b||d==Array&&s(b))for(i=new d(t=l(f.length));t>m;m++)c(i,m,g?h(f[m],m):f[m]);else for(p=b.call(f),i=new d;!(r=p.next()).done;m++)c(i,m,g?a(p,h,[r.value,m],!0):r.value);return i.length=m,i}})}});